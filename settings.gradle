pluginManagement {
    repositories {
        gradlePluginPortal() {
            content {
                excludeGroupByRegex 'com\\.brightspot($|\\..+)'
                excludeGroupByRegex 'com\\.psddev($|\\..+)'
            }
        }
        maven {
            url 'https://artifactory.psdops.com/public'
        }
    }
}

plugins {
    id 'com.gradle.enterprise' version '3.15.1'
    id 'com.brightspot.gradle' version '3.1.0-rc3'
}

rootProject.name = 'brightspot-training'

dependencyResolutionManagement {
    versionCatalogs {
        brightspotLibs {
            library('brightspot', 'com.psddev:brightspot-bom:4.7.11.1')
            library('brightspotDependencies', 'com.psddev:brightspot-dependencies:4.7.11.1')

            library('brightspotSharedTests' , 'com.brightspot.shared-tests:bom:0.7.1')

            library('brightspotGo', 'com.brightspot.go:bom:1.5.3')
            library('brightspotGoDependencies', 'com.brightspot.go:go-dependencies:1.5.3')

            library('componentLib', 'com.psddev.component-lib:bom:4.5.24')
            library('componentLibDependencies', 'com.psddev.component-lib:cl-dependencies:4.5.24')
        }
    }
}

brightspot {
    projectGroup = 'com.brightspot-training'

    // versions {
    //     brightspot = '4.7.11.1'
    //     brightspotGo = '1.5.3'
    //     sharedTests = '0.7.1'
    //     componentLib = '4.5.24'
    //     java = 11
    // }

    dependencyConstraints = [
        // dependency conflicts across Gradle configurations
        'com.fasterxml.jackson.core:jackson-core': '2.11.0',
        'com.google.api-client:google-api-client': '1.33.4',
        'com.squareup.retrofit2:converter-jackson': '2.9.0',
    ]

    dependencySubstitutions = [
        'javax.inject:javax.inject': 'org.glassfish.hk2.external:javax.inject:_',

        // Go's lib-util-auto-dependency-test uses the CL version
        'com.psddev.component-lib:test-utils': 'com.brightspot.shared-tests:util-filtered-class-finder:0.7.1.2-xfea2e1', // from 0.7.1
    ]
}

include(':core')
include(':web')
include(':frontend')
include(':bundle-default')

project(':core').projectDir = file('core')
project(':web').projectDir = file('web')
project(':frontend').projectDir = file('frontend')
project(':bundle-default').projectDir = file('frontend/bundles/bundle-default')

gradleEnterprise {
    buildScan {
        termsOfServiceUrl = "https://gradle.com/terms-of-service"
        termsOfServiceAgree = "yes"
    }
}
